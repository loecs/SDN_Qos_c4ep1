<!DOCTYPE html>
{% load static %}
<html>

<head>
    <meta charset="utf-8">
    <title>SDN</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 引入Element UI组件库样式和JS文件 -->
   <link rel="stylesheet" href="{% static 'css/element-ui.css' %}">
    <link rel="stylesheet" href="{% static 'css/vis-network.min.css' %}">
    <script src="{% static 'js/vue.min.js' %}"></script>
    <script src="{% static 'js/element-ui.js' %}"></script>
    <!-- 引入axios和自定义样式 -->
    <script src="{% static 'js/vis-network.min.js' %}"></script>
    <script src="{% static 'js/axios.min.js' %}"></script>
    <script src="{% static 'js/echarts.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
</head>

<body>
    <div id="app">
        <el-container>
            <el-header class="header" style="margin: 4px; ">
                <el-row justify="space-between">
                    <el-col :span="12">
                        <div class="header-title">SDN管理系统</div>
                    </el-col>
                    <el-col :span="12" align="right">
                        <el-dropdown trigger="hover">
                            <span class="avatar-wrapper">
                                <el-image :src="avatarUrl" class="avatar"></el-image>
                            </span>
                            <el-dropdown-menu slot="dropdown">
                                <el-dropdown-item @click="logout">退出</el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                        <span class="header-text"></span>
                    </el-col>
                </el-row>
            </el-header>
            <el-container>
                <el-aside width="250px" class="nav" style="margin-top: -4px; margin-left: 0px;">
                    <el-menu default-active="2" class="el-menu-vertical-demo menu" router>
                        <el-menu-item index="1"><a href="{% url 'index' %}" class="link">首页</a></el-menu-item>
                        <el-menu-item index="2"><a href="{% url 'link-info' %}" class="link">链路信息</a></el-menu-item>
                        <el-menu-item index="3"><a href="{% url 'unusual-traffic' %}" class="link">异常流量</a></el-menu-item>
                        <el-menu-item index="4"><a href="{% url 'flow-table' %}" class="link">流表管理</a></el-menu-item>
                        <el-menu-item index="5"><a href="{% url 'meter-table' %}" class="link">meter表管理</a></el-menu-item>
                        <el-menu-item index="5"><a href="#" class="link">业务分类</a></el-menu-item>
                        <el-menu-item index="6"><a href="#" class="link">QoS策略</a></el-menu-item>
                    </el-menu>
                </el-aside>
                <el-main >
                    <div>
                        <el-table :data="filteredTableData" border style="width: 100%"
                            header-row-class-name="header-row-class">
                            <el-table-column prop="id" label="序号" width="120"></el-table-column>
                            <el-table-column prop="record_time" label="时间" width="220"></el-table-column>
                            <el-table-column prop="link_id" label="链路ID" width="200"></el-table-column>
                            <el-table-column prop="throughput" label="吞吐量" width="220"></el-table-column>
                            <el-table-column prop="delay" label="时延" width="205"></el-table-column>
                            <el-table-column prop="jitter" label="抖动" width="205"></el-table-column>
                            <el-table-column prop="loss" label="丢包率" width="200"></el-table-column>
                        </el-table>
                        <div style="margin-top: 10px; text-align: right;">
                            <el-pagination layout="prev, pager, next" :page-size="15" :total="tableData.length"
                                @current-change="handleCurrentChange">
                            </el-pagination>
                        </div>
                    </div>
                </el-main>
            </el-container>
        </el-container>

        <!-- 弹出框组件 -->

    </div>

    <script>
        new Vue({
            el: '#app',
            data: function () {
                return {
                    avatarUrl: "{% static 'img/img1.png' %}",
                    tableData: [],
                    currentPage: 1,
                    pageSize: 15,
                    dialogVisible: false,
                    form: {
                        link_id: '',
                        throughput: '',
                        delay: '',
                        jitter: '',
                        loss: ''
                    }
                }
            },
            computed: {
                filteredTableData() {
                    const start = (this.currentPage - 1) * this.pageSize;
                    return this.tableData.slice(start, start + this.pageSize);
                }
            },
            mounted() {
                axios.get('{% static 'show-data/link-data.json'%}').then(response => {
                    let dataStr = JSON.stringify(response.data)
                    let data = JSON.parse(dataStr)
                    this.tableData = data.data
                }).catch(error => {
                    console.log(error)
                })
            },
            methods: {
                logout() {
                    // 执行退出操作，比如清除本地存储的登录信息等
                    window.location.href = "login.html";
                },

                handleCurrentChange(page) {
                    this.currentPage = page;
                },
                addTableRow() {
                    const newTableData = {
                        id: this.tableData.length + 1,
                        record_time: '2023-06-18 15:00:00',
                        link_id: this.form.link_id,
                        throughput: this.form.throughput,
                        delay: this.form.delay,
                        jitter: this.form.jitter,
                        loss: this.form.loss
                    };
                    this.tableData.push(newTableData);
                    this.dialogVisible = false;
                }
            }
        });
    </script>
</body>

</html>